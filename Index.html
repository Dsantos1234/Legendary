<!DOCTYPE html>
<html lang="en">
<!-- Previous head and style sections remain the same -->
<head>
    <!-- Previous styles remain the same -->
</head>
<body>
    <div class="stars"></div>
    <div class="background-ufo">üõ∏</div>

    <h1>Area 51 Escape - Enhanced Edition üëΩ</h1>
    <div id="level-info">Level 1</div>
    <div id="stats">Score: 0 | Keycards: 0/3 | Health: ‚ù§Ô∏è‚ù§Ô∏è‚ù§Ô∏è</div>
    <div id="game-container">
        <div class="facility-element control-panel" style="top: 20px; left: 30px">
            <div class="blinking-light" style="top: 5px; left: 5px"></div>
            <div class="blinking-light" style="top: 5px; right: 5px"></div>
        </div>
        <div class="facility-element control-panel" style="top: 20px; right: 30px">
            <div class="blinking-light" style="top: 5px; left: 5px"></div>
            <div class="blinking-light" style="top: 5px; right: 5px"></div>
        </div>
        
        <div id="alien">üëΩ</div>
        <div id="game-over">
            Game Over!<br>
            <button class="btn" onclick="resetGame()">Try Again</button>
        </div>
        <div id="level-complete">
            Level Complete!<br>
            <button class="btn" onclick="nextLevel()">Next Level</button>
        </div>
    </div>
    
    <div id="mobile-controls">
        <div class="control-group">
            <button class="control-btn" id="jumpBtn">‚¨ÜÔ∏è</button>
        </div>
        <div class="control-group">
            <button class="control-btn" id="leftBtn">‚¨ÖÔ∏è</button>
            <button class="control-btn" id="rightBtn">‚û°Ô∏è</button>
        </div>
    </div>

    <button class="btn" onclick="startGame()">Start Game</button>

    <div id="leaderboard">
        <h2>Top Scores</h2>
        <div id="leaderboard-entries"></div>
    </div>

    <script>
        // Game variables
        const alien = document.getElementById('alien');
        const gameContainer = document.getElementById('game-container');
        const statsElement = document.getElementById('stats');
        const levelInfoElement = document.getElementById('level-info');
        const gameOverElement = document.getElementById('game-over');
        const levelCompleteElement = document.getElementById('level-complete');
        const leaderboardEntriesElement = document.getElementById('leaderboard-entries');

        let score = 0;
        let keycards = 0;
        let health = 3;
        let level = 1;
        let isJumping = false;
        let jumpForce = 0;
        let isGameRunning = false;
        let hasShield = false;
        let guardInterval, keycardInterval, powerupInterval;
        const keys = {};

        // Level configuration
        const levelConfig = {
            1: { guardSpeed: 4, guardInterval: 2000, keycardsNeeded: 3, powerupChance: 0.3 },
            2: { guardSpeed: 5, guardInterval: 1800, keycardsNeeded: 4, powerupChance: 0.25 },
            3: { guardSpeed: 6, guardInterval: 1600, keycardsNeeded: 4, powerupChance: 0.2 },
            4: { guardSpeed: 7, guardInterval: 1400, keycardsNeeded: 5, powerupChance: 0.15 },
            5: { guardSpeed: 8, guardInterval: 1200, keycardsNeeded: 5, powerupChance: 0.1 }
        };

        // Game mechanics
        function startGame() {
            if (isGameRunning) return;
            score = 0;
            level = 1;
            keycards = 0;
            health = 3;
            startLevel();
        }

        function startLevel() {
            isGameRunning = true;
            updateStats();
            document.querySelectorAll('.guard, .keycard, .powerup').forEach(el => el.remove());
            alien.style.bottom = '20px';
            alien.style.left = '50px';
            gameOverElement.style.display = 'none';
            levelCompleteElement.style.display = 'none';
            
            guardInterval = setInterval(createGuard, levelConfig[level].guardInterval);
            keycardInterval = setInterval(createKeycard, 3000);
            powerupInterval = setInterval(createPowerup, 5000);
            requestAnimationFrame(gameLoop);
        }

        function createGuard() {
            if (!isGameRunning) return;
            const guard = document.createElement('div');
            guard.className = 'guard';
            guard.innerHTML = 'üëÆ';
            guard.style.bottom = `${Math.random() * 200}px`;
            guard.style.right = '-30px';
            gameContainer.appendChild(guard);
            moveGuard(guard);
        }

        function moveGuard(guard) {
            if (!isGameRunning) {
                guard.remove();
                return;
            }
            
            let left = parseFloat(guard.style.left) || gameContainer.clientWidth;
            if (left < -30) {
                guard.remove();
                score += 10;
                updateStats();
            } else {
                guard.style.left = `${left - levelConfig[level].guardSpeed}px`;
                requestAnimationFrame(() => moveGuard(guard));
            }
        }

        function createKeycard() {
            if (!isGameRunning || keycards >= levelConfig[level].keycardsNeeded) return;
            const keycard = document.createElement('div');
            keycard.className = 'keycard';
            keycard.innerHTML = 'üîë';
            keycard.style.left = `${Math.random() * (gameContainer.clientWidth - 50) + 50}px`;
            keycard.style.bottom = `${Math.random() * 300 + 50}px`;
            gameContainer.appendChild(keycard);
        }

        function gameLoop() {
            if (!isGameRunning) return;

            // Handle jumping
            if (!isJumping && keys.ArrowUp) {
                isJumping = true;
                jumpForce = 15;
            }
            
            if (isJumping) {
                let bottom = parseFloat(alien.style.bottom) || 20;
                jumpForce -= 0.8;
                bottom += jumpForce;
                
                if (bottom <= 20) {
                    bottom = 20;
                    isJumping = false;
                }
                alien.style.bottom = `${bottom}px`;
            }
            
            // Handle horizontal movement
            let left = parseFloat(alien.style.left) || 50;
            if (keys.ArrowLeft && left > 0) left -= 5;
            if (keys.ArrowRight && left < gameContainer.clientWidth - 40) left += 5;
            alien.style.left = `${left}px`;
            
            checkCollisions();
            requestAnimationFrame(gameLoop);
        }

        // Collision detection and game state management functions here
        // [Previous collision detection code remains the same]

        // Event listeners
        document.addEventListener('keydown', e => {
            keys[e.code] = true;
            if (['ArrowUp', 'ArrowDown', 'ArrowLeft', 'ArrowRight', ' '].includes(e.code)) {
                e.preventDefault();
            }
        });
        
        document.addEventListener('keyup', e => keys[e.code] = false);

        // Initialize mobile controls
        setupMobileControls();
        
        // Start background effects
        createBackgroundUFOs();
        createStars();
        createFacilityElements();
    </script>
</body>
</html>
