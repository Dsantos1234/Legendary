<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Area 51 Escape - Enhanced Edition</title>
    <style>
        :root {
            --primary: #22c55e;
            --primary-hover: #16a34a;
            --game-height: min(400px, 70vh);
        }
        
        body { 
            margin: 0; 
            font-family: system-ui, -apple-system, sans-serif;
            display: flex; 
            flex-direction: column; 
            align-items: center; 
            color: #fff;
            overflow: hidden;
            touch-action: none;
            -webkit-tap-highlight-color: transparent;
            height: 100vh;
            padding: 10px;
            box-sizing: border-box;
            background: radial-gradient(circle at center, #001a33, #000011);
            position: relative;
            overflow-y: auto;
        }

        /* New UFO Background Elements */
        .background-ufo {
            position: fixed;
            width: 100px;
            height: 60px;
            opacity: 0.2;
            pointer-events: none;
            animation: floatUfo 15s infinite linear;
            z-index: 0;
        }

        @keyframes floatUfo {
            0% { transform: translate(-100vw, 20vh) rotate(5deg); }
            100% { transform: translate(100vw, 40vh) rotate(-5deg); }
        }

        /* Enhanced Stars Background */
        .stars {
            position: fixed;
            width: 100vw;
            height: 100vh;
            background-image: 
                radial-gradient(2px 2px at 20px 30px, #fff, rgba(0,0,0,0)),
                radial-gradient(2px 2px at 40px 70px, #fff, rgba(0,0,0,0)),
                radial-gradient(2px 2px at 50px 160px, #fff, rgba(0,0,0,0)),
                radial-gradient(2px 2px at 90px 40px, #fff, rgba(0,0,0,0)),
                radial-gradient(2px 2px at 130px 80px, #fff, rgba(0,0,0,0));
            background-size: 200px 200px;
            animation: twinkle 4s infinite;
            pointer-events: none;
        }

        #game-container { 
            position: relative; 
            width: min(800px, 100%);
            height: var(--game-height);
            background: linear-gradient(rgba(0,0,51,0.8), rgba(0,0,102,0.8));
            margin: 10px 0; 
            overflow: hidden; 
            border: 2px solid var(--primary);
            border-radius: 8px;
            touch-action: none;
            box-shadow: 0 0 20px rgba(34, 197, 94, 0.2);
            backdrop-filter: blur(5px);
        }

        /* Alien Research Facility Elements */
        .facility-element {
            position: absolute;
            background: rgba(34, 197, 94, 0.1);
            border: 1px solid var(--primary);
            pointer-events: none;
        }

        .control-panel {
            position: absolute;
            width: 60px;
            height: 40px;
            background: linear-gradient(45deg, #000, #222);
            border: 1px solid var(--primary);
            box-shadow: 0 0 10px rgba(34, 197, 94, 0.3);
        }

        .blinking-light {
            position: absolute;
            width: 4px;
            height: 4px;
            background: var(--primary);
            border-radius: 50%;
            animation: blink 1s infinite;
        }

        @keyframes blink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.3; }
        }

        /* Rest of your existing styles remain the same */
        /* [Previous styles for #alien, .guard, .keycard, etc.] */

        /* Enhanced visual effects */
        .shield {
            position: absolute;
            width: 100%;
            height: 100%;
            border: 3px solid #00ffff;
            border-radius: 50%;
            animation: pulseShield 1s infinite;
            pointer-events: none;
            box-shadow: 0 0 15px rgba(0, 255, 255, 0.5);
        }

        @keyframes pulseShield {
            0%, 100% { transform: scale(1); opacity: 0.5; }
            50% { transform: scale(1.1); opacity: 0.8; }
        }

        .guard {
            /* Previous guard styles plus: */
            background: radial-gradient(circle at center, rgba(255,0,0,0.2), transparent);
        }

        .keycard {
            /* Previous keycard styles plus: */
            box-shadow: 0 0 10px rgba(255, 255, 0, 0.5);
        }

        #level-info {
            text-shadow: 0 0 10px var(--primary);
        }

        /* [Rest of your existing styles remain unchanged] */
    </style>
</head>
<body>
    <!-- Background Elements -->
    <div class="stars"></div>
    <div class="background-ufo">üõ∏</div>

    <h1>Area 51 Escape - Enhanced Edition üëΩ</h1>
    <div id="level-info">Level 1</div>
    <div id="stats">Score: 0 | Keycards: 0/3 | Health: ‚ù§Ô∏è‚ù§Ô∏è‚ù§Ô∏è</div>
    <div id="game-container">
        <!-- Facility Background Elements -->
        <div class="facility-element control-panel" style="top: 20px; left: 30px">
            <div class="blinking-light" style="top: 5px; left: 5px"></div>
            <div class="blinking-light" style="top: 5px; right: 5px"></div>
        </div>
        <div class="facility-element control-panel" style="top: 20px; right: 30px">
            <div class="blinking-light" style="top: 5px; left: 5px"></div>
            <div class="blinking-light" style="top: 5px; right: 5px"></div>
        </div>
        
        <div id="alien">üëΩ</div>
        <div id="game-over">
            Game Over!<br>
            <button class="btn" onclick="resetGame()">Try Again</button>
        </div>
        <div id="level-complete">
            Level Complete!<br>
            <button class="btn" onclick="nextLevel()">Next Level</button>
        </div>
    </div>
    
    <!-- [Rest of your existing HTML remains unchanged] -->
    <!-- [Previous mobile controls, buttons, and leaderboard] -->

    <script>
        // [Your previous JavaScript code remains the same until the animation parts]
        
        // Add dynamic UFO backgrounds
        function createBackgroundUFOs() {
            setInterval(() => {
                const ufo = document.createElement('div');
                ufo.className = 'background-ufo';
                ufo.innerHTML = 'üõ∏';
                document.body.appendChild(ufo);
                
                // Remove UFO after animation completes
                setTimeout(() => ufo.remove(), 15000);
            }, 10000);
        }

        // Enhanced star creation
        function createStars() {
            const starsContainer = document.querySelector('.stars');
            const numStars = 100;
            
            for (let i = 0; i < numStars; i++) {
                const star = document.createElement('div');
                star.style.position = 'absolute';
                star.style.left = `${Math.random() * 100}%`;
                star.style.top = `${Math.random() * 100}%`;
                star.style.width = `${Math.random() * 2 + 1}px`;
                star.style.height = star.style.width;
                star.style.backgroundColor = 'white';
                star.style.opacity = Math.random();
                star.style.borderRadius = '50%';
                starsContainer.appendChild(star);
                
                // Animate star twinkling
                setInterval(() => {
                    star.style.opacity = Math.random();
                }, Math.random() * 3000 + 1000);
            }
        }

        // Add facility elements dynamically
        function createFacilityElements() {
            const numElements = 5;
            for (let i = 0; i < numElements; i++) {
                const element = document.createElement('div');
                element.className = 'facility-element';
                element.style.width = `${Math.random() * 30 + 20}px`;
                element.style.height = `${Math.random() * 30 + 20}px`;
                element.style.left = `${Math.random() * 100}%`;
                element.style.top = `${Math.random() * 100}%`;
                gameContainer.appendChild(element);
            }
        }

        // Initialize enhanced visuals
        createBackgroundUFOs();
        createStars();
        createFacilityElements();

        // [Rest of your existing JavaScript code remains unchanged]
        
        // Initialize game
        setupMobileControls();
        updateLeaderboard();
    </script>
</body>
</html>
